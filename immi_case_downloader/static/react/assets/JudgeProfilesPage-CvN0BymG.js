import{j as e}from"./query-DQVcjD57.js";import{u as B,r as c}from"./vendor-CxW-pF4z.js";import{u as y,a as v}from"./index-Bnk0r1Pl.js";import{A as T}from"./AnalyticsFilters-BERX9T28.js";import{C as I}from"./CourtBadge-BrIX0RTk.js";import{c as P}from"./tokens-CHeescls.js";import{a as Y,u as O}from"./use-judges-De0dOjwj.js";import{S as U}from"./scale-DvaxjazT.js";import{B as q}from"./briefcase-DPcmmz4c.js";import{A as D}from"./ApiErrorState-DaJ93vn1.js";import{L as G,a as V}from"./list-DfgsIiD-.js";import"./charts-CKTqRh7i.js";import"./api-mEKAgK73.js";function W({data:s,selectedNames:a,onToggleCompare:d,onOpen:p}){const{t:o}=y();return s.length?e.jsx("div",{className:"overflow-x-auto rounded-lg border border-border bg-card",children:e.jsxs("table",{className:"w-full min-w-[1000px] text-sm",children:[e.jsx("thead",{children:e.jsxs("tr",{className:"border-b border-border bg-surface text-left text-xs uppercase tracking-wide text-muted-text",children:[e.jsx("th",{className:"px-3 py-2",children:o("judges.compare")}),e.jsx("th",{className:"px-3 py-2",children:o("judges.judge_member")}),e.jsx("th",{className:"px-3 py-2",children:o("judges.total_cases")}),e.jsx("th",{className:"px-3 py-2",children:o("judges.approval_rate")}),e.jsx("th",{className:"px-3 py-2",children:o("judges.active_years_column")}),e.jsx("th",{className:"px-3 py-2",children:o("judges.courts")}),e.jsx("th",{className:"px-3 py-2",children:o("judges.top_visa_subclasses")})]})}),e.jsx("tbody",{children:s.map(r=>e.jsxs("tr",{className:"cursor-pointer border-b border-border-light/60 hover:bg-surface/50",onClick:()=>p(r.name),children:[e.jsx("td",{className:"px-3 py-2",onClick:n=>{n.stopPropagation()},children:e.jsx("input",{"aria-label":`Compare ${r.name}`,type:"checkbox",checked:a.includes(r.name),onChange:()=>d(r.name)})}),e.jsx("td",{className:"px-3 py-2 font-medium text-foreground",children:r.name}),e.jsx("td",{className:"px-3 py-2 text-secondary-text",children:r.total_cases.toLocaleString()}),e.jsx("td",{className:"px-3 py-2",children:e.jsxs("div",{className:"w-40",children:[e.jsxs("div",{className:"mb-1 text-xs text-secondary-text",children:[r.approval_rate.toFixed(1),"%"]}),e.jsx("div",{className:"h-2 rounded bg-surface",children:e.jsx("div",{className:"h-2 rounded bg-accent",style:{width:`${Math.min(r.approval_rate,100)}%`}})})]})}),e.jsxs("td",{className:"px-3 py-2 whitespace-nowrap text-secondary-text",children:[r.active_years.first??"-"," – ",r.active_years.last??"-"]}),e.jsx("td",{className:"px-3 py-2 text-secondary-text",children:r.courts.join(", ")||"-"}),e.jsx("td",{className:"px-3 py-2 text-secondary-text",children:r.top_visa_subclasses[0]?`${r.top_visa_subclasses[0].subclass} (${r.top_visa_subclasses[0].count})`:"-"})]},r.name))})]})}):e.jsx("p",{className:"text-sm text-muted-text",children:o("judges.no_judge_records")})}function X({judge:s,isSelected:a,onToggleCompare:d,onOpen:p}){const{t:o}=y(),r=P[s.primary_court??""]??"#6b7585",n=s.active_years.first&&s.active_years.last?s.active_years.first===s.active_years.last?`${s.active_years.first}`:`${s.active_years.first} – ${s.active_years.last}`:null;return e.jsx("button",{type:"button",onClick:()=>p(s.name),className:"group flex min-h-[180px] flex-col rounded-lg border border-border bg-card text-left shadow-xs transition-all duration-150 hover:-translate-y-0.5 hover:shadow-md",style:{borderLeftWidth:"3px",borderLeftColor:r},children:e.jsxs("div",{className:"flex flex-1 flex-col p-4",children:[e.jsxs("div",{className:"mb-2 flex flex-wrap items-center gap-1.5",children:[s.courts.map(m=>e.jsx(I,{court:m},m)),e.jsxs("span",{className:v("ml-auto shrink-0 rounded-sm px-2 py-0.5 text-xs font-semibold",Y(s.approval_rate)),children:[s.approval_rate.toFixed(1),"%"]})]}),e.jsx("h3",{className:"line-clamp-1 text-sm font-semibold text-foreground transition-colors group-hover:text-accent",children:s.name}),n&&e.jsx("p",{className:"mt-0.5 text-xs text-muted-text",children:n}),e.jsx("div",{className:"mt-auto"}),e.jsx("div",{className:"mt-3 border-t border-border-light pt-2.5",children:e.jsxs("div",{className:"flex items-center justify-between gap-2 text-xs text-muted-text",children:[e.jsxs("div",{className:"flex flex-wrap gap-x-4 gap-y-1",children:[e.jsxs("span",{className:"inline-flex items-center gap-1",children:[e.jsx(U,{className:"h-3 w-3 shrink-0"}),s.total_cases.toLocaleString()," ",o("judges.cases")]}),s.top_visa_subclasses[0]&&e.jsxs("span",{className:"inline-flex items-center gap-1 truncate",title:s.top_visa_subclasses[0].subclass,children:[e.jsx(q,{className:"h-3 w-3 shrink-0"}),s.top_visa_subclasses[0].subclass]})]}),e.jsxs("label",{className:"inline-flex shrink-0 cursor-pointer items-center gap-1",onClick:m=>m.stopPropagation(),children:[e.jsx("input",{type:"checkbox","aria-label":`Compare ${s.name}`,checked:a,onChange:()=>d(s.name)}),e.jsx("span",{className:"select-none text-[11px]",children:o("judges.compare")})]})]})})]})})}const z=new Date().getFullYear(),N=4;function de(){const s=B(),{t:a}=y(),[d,p]=c.useState(""),[o,r]=c.useState(2e3),[n,m]=c.useState(z),[g,L]=c.useState("cases"),[b,$]=c.useState(""),[i,_]=c.useState([]),[u,C]=c.useState(()=>localStorage.getItem("judges-view-mode")==="cards"?"cards":"table"),E=c.useMemo(()=>({court:d||void 0,yearFrom:o,yearTo:n,sort_by:g,limit:100}),[d,o,n,g]),{data:R,isLoading:F,isError:A,error:w,refetch:J}=O(E),x=R?.judges??[],h=c.useMemo(()=>{const t=b.trim().toLowerCase();return t?x.filter(l=>l.name.toLowerCase().includes(t)):x},[x,b]);c.useEffect(()=>{if(!x.length)return;const t=new Set(x.map(l=>l.name));_(l=>{const j=l.filter(f=>t.has(f));return j.length===l.length?l:j})},[x]);const k=t=>{_(l=>l.includes(t)?l.filter(f=>f!==t):l.length>=N?l:[...l,t])},M=()=>{if(i.length<2)return;const t=i.map(l=>encodeURIComponent(l)).join(",");s(`/judge-profiles/compare?names=${t}`)},S=t=>{s(`/judge-profiles/${encodeURIComponent(t)}`)};return e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-semibold text-foreground",children:a("judges.title")}),e.jsx("p",{className:"text-sm text-muted-text",children:a("judges.subtitle")})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("button",{type:"button","aria-label":a("tooltips.table_view"),"aria-pressed":u==="table",onClick:()=>{C("table"),localStorage.setItem("judges-view-mode","table")},className:v("rounded-md p-1.5",u==="table"?"bg-accent-muted text-accent":"text-muted-text hover:text-foreground"),title:a("judges.table_view_label"),children:e.jsx(G,{className:"h-4 w-4"})}),e.jsx("button",{type:"button","aria-label":a("tooltips.chart_view"),"aria-pressed":u==="cards",onClick:()=>{C("cards"),localStorage.setItem("judges-view-mode","cards")},className:v("rounded-md p-1.5",u==="cards"?"bg-accent-muted text-accent":"text-muted-text hover:text-foreground"),title:a("judges.card_view_label"),children:e.jsx(V,{className:"h-4 w-4"})})]})]}),e.jsxs("div",{className:"rounded-lg border border-border bg-card p-4",children:[e.jsxs("div",{className:"mb-3 flex flex-wrap items-center justify-between gap-3",children:[e.jsx(T,{court:d,yearFrom:o,yearTo:n,onCourtChange:p,onYearRangeChange:(t,l)=>{r(t),m(l)}}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("input",{type:"text",placeholder:a("judges.search_placeholder"),value:b,onChange:t=>$(t.target.value),className:"rounded-md border border-border bg-background px-2 py-1.5 text-sm text-foreground placeholder:text-muted-text"}),e.jsx("label",{className:"text-xs font-medium uppercase tracking-wide text-muted-text",children:a("judges.sort_label")}),e.jsxs("select",{value:g,onChange:t=>L(t.target.value),className:"rounded-md border border-border bg-background px-2 py-1.5 text-sm text-foreground",children:[e.jsx("option",{value:"cases",children:a("judges.sort_cases")}),e.jsx("option",{value:"approval_rate",children:a("judges.sort_approval")}),e.jsx("option",{value:"name",children:a("judges.sort_name")})]})]})]}),e.jsxs("div",{className:"mb-3 flex items-center justify-between",children:[e.jsx("p",{className:"text-sm text-secondary-text",children:a("judges.judges_found",{count:h.length})}),e.jsxs("div",{className:"flex items-center gap-2",children:[i.length>=N&&e.jsx("span",{className:"text-xs text-semantic-warning",children:a("judges.max_selected",{max:N})}),e.jsx("button",{type:"button",onClick:M,disabled:i.length<2,className:"rounded-md bg-accent px-3 py-1.5 text-sm font-medium text-white disabled:cursor-not-allowed disabled:opacity-50",children:a("judges.compare_selected",{count:i.length})})]})]}),F?e.jsx("p",{className:"text-sm text-muted-text",children:a("judges.loading_judges")}):A?e.jsx(D,{title:a("errors.failed_to_load",{name:"judges"}),message:w instanceof Error?w.message:a("errors.api_request_failed",{name:"Judge"}),onRetry:()=>{J()}}):u==="table"?e.jsx(W,{data:h,selectedNames:i,onToggleCompare:k,onOpen:S}):h.length===0?e.jsx("p",{className:"text-sm text-muted-text",children:a("judges.empty_state")}):e.jsx("div",{className:"grid gap-4 sm:grid-cols-2 lg:grid-cols-3",children:h.map(t=>e.jsx(X,{judge:t,isSelected:i.includes(t.name),onToggleCompare:k,onOpen:S},t.name))})]})]})}export{de as JudgeProfilesPage};
