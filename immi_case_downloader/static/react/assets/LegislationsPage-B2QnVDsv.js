import{j as e}from"./query-DQVcjD57.js";import{i as P,u as _,r}from"./vendor-CxW-pF4z.js";import{u as T,a as k}from"./use-legislations-WFpQAPu9.js";import{B as R}from"./Breadcrumb-Cxpvkl8D.js";import{P as D}from"./Pagination-UjnCeP2v.js";import{E}from"./EmptyState-CkBAjrMN.js";import{u as B,S as U,a as g}from"./index-DVepBQ7E.js";import{C as q}from"./chevron-right-Ba97YGnb.js";import"./api-CH3UgZL0.js";import"./chevron-left-dzkZi3zV.js";import"./charts-CKTqRh7i.js";function M(s){if(!s)return"";const n=new Date(s);return isNaN(n.getTime())?s:n.toLocaleDateString("en-AU",{day:"numeric",month:"short",year:"numeric"})}function W(){const{t:s}=B(),[n,c]=P(),f=_(),a=n.get("q")??"",h=Number(n.get("page")??1),u=20,[j,b]=r.useState(a),i=r.useRef(null);r.useEffect(()=>()=>{i.current&&clearTimeout(i.current)},[]);const{data:o,isLoading:N}=T(a?1:h,u),{data:x,isLoading:v}=k(a,u),d=a?x:o,y=a?v:N,p=r.useMemo(()=>d?a?d.data||[]:d.data||[]:[],[d,a]),S=r.useMemo(()=>a?x?.meta?.total_results??0:o?.meta?.total??0,[o,x,a]),w=r.useMemo(()=>a?1:o?.meta?.pages??1,[o,a]),L=r.useCallback(t=>{b(t),i.current&&clearTimeout(i.current);const m=setTimeout(()=>{const l=new URLSearchParams;t?(l.set("q",t),l.set("page","1")):(l.delete("q"),l.set("page","1")),c(l)},300);i.current=m},[c]),V=r.useCallback(t=>{const m=new URLSearchParams(n);m.set("page",String(t)),c(m),window.scrollTo({top:0,behavior:"smooth"})},[n,c]),C=r.useCallback(t=>{f(`/legislations/${t}`)},[f]);return e.jsxs("div",{className:"space-y-4",children:[e.jsx(R,{items:[{label:s("common.dashboard"),href:"/"},{label:s("legislations.title",{defaultValue:"Legislations"})}]}),e.jsxs("div",{className:"rounded-lg border border-border bg-card p-5",children:[e.jsx("h1",{className:"font-heading text-2xl font-semibold text-foreground",children:s("legislations.title",{defaultValue:"Legislations"})}),e.jsx("p",{className:"mt-1 text-sm text-secondary-text",children:s("legislations.description",{defaultValue:"Browse and search legislation relevant to immigration law"})})]}),e.jsx("div",{className:"rounded-lg border border-border bg-card p-4",children:e.jsxs("div",{className:"relative",children:[e.jsx(U,{className:"absolute left-3 top-1/2 h-4 w-4 -translate-y-1/2 text-muted-text"}),e.jsx("input",{type:"text",placeholder:s("common.search",{defaultValue:"Search legislations..."}),value:j,onChange:t=>L(t.target.value),className:g("w-full rounded-md border border-border bg-surface px-3 py-2 pl-10 text-sm","text-foreground placeholder:text-muted-text","focus:border-accent focus:outline-none focus:ring-1 focus:ring-accent/50")})]})}),y?e.jsx("div",{className:"flex h-64 items-center justify-center text-muted-text",children:s("common.loading_ellipsis")}):p.length===0?e.jsx(E,{icon:"BookOpen",title:a?s("common.no_results",{defaultValue:"No results found"}):s("common.no_data",{defaultValue:"No legislations"}),description:a?s("common.try_different_search",{defaultValue:"Try adjusting your search terms"}):s("legislations.no_data_description",{defaultValue:"No legislations available yet"})}):e.jsx("div",{className:"space-y-3",children:p.map(t=>e.jsx("button",{onClick:()=>C(t.id),className:g("w-full rounded-lg border border-border bg-card p-4 text-left","transition-colors hover:border-accent hover:bg-surface"),children:e.jsxs("div",{className:"flex items-start justify-between gap-4",children:[e.jsxs("div",{className:"min-w-0 flex-1",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("h3",{className:"font-heading text-base font-semibold text-foreground",children:t.title}),t.shortcode&&e.jsx("span",{className:"inline-flex items-center rounded-md bg-accent/10 px-2 py-0.5 text-xs font-medium text-accent",children:t.shortcode})]}),t.description&&e.jsx("p",{className:"mt-1.5 line-clamp-2 text-sm text-secondary-text",children:t.description}),e.jsxs("div",{className:"mt-2.5 flex flex-wrap gap-3 text-xs text-muted-text",children:[t.jurisdiction&&e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsxs("span",{className:"font-medium",children:[s("legislations.jurisdiction",{defaultValue:"Jurisdiction"}),":"]}),e.jsx("span",{children:t.jurisdiction})]}),t.type&&e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsxs("span",{className:"font-medium",children:[s("legislations.type",{defaultValue:"Type"}),":"]}),e.jsx("span",{children:t.type})]}),t.sections&&e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsxs("span",{className:"font-medium",children:[s("legislations.sections",{defaultValue:"Sections"}),":"]}),e.jsx("span",{children:t.sections})]}),t.updated_date&&e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsxs("span",{className:"font-medium",children:[s("legislations.updated",{defaultValue:"Updated"}),":"]}),e.jsx("span",{children:M(t.updated_date)})]})]})]}),e.jsx(q,{className:"mt-1 h-5 w-5 shrink-0 text-muted-text transition-transform group-hover:translate-x-0.5"})]})},t.id))}),!a&&p.length>0&&e.jsx("div",{className:"flex justify-center pt-4",children:e.jsx(D,{currentPage:h,totalPages:w,totalItems:S,pageSize:u,onPageChange:V})})]})}export{W as LegislationsPage};
