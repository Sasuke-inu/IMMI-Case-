import{u as j,k as b,j as e}from"./query-DQVcjD57.js";import{K as v}from"./api-BvrL3ogf.js";import{r as f,u as A}from"./vendor-CxW-pF4z.js";import{c as g}from"./tokens-CHeescls.js";import{c as C,u as x}from"./index-BVFuTJQG.js";import{R as N,B as y,b as T,X as _,Y as R,T as F,L as k,d as w,C as L}from"./charts-CKTqRh7i.js";import{G as p}from"./git-branch-BHCos_Qc.js";import{A as M}from"./arrow-right-z14XMCc9.js";import{S}from"./scale-xW6c7V4o.js";import{A as h}from"./ApiErrorState-DXu3A0Ul.js";import{E as D}from"./EmptyState-G-Z6VqX3.js";const E=[["path",{d:"M10 12h4",key:"a56b0p"}],["path",{d:"M10 8h4",key:"1sr2af"}],["path",{d:"M14 21v-3a2 2 0 0 0-4 0v3",key:"1rgiei"}],["path",{d:"M6 10H4a2 2 0 0 0-2 2v7a2 2 0 0 0 2 2h16a2 2 0 0 0 2-2V9a2 2 0 0 0-2-2h-2",key:"secmi2"}],["path",{d:"M6 21V5a2 2 0 0 1 2-2h8a2 2 0 0 1 2 2v16",key:"16ra0t"}]],G=C("building-2",E);function z(){return j({queryKey:["lineage"],queryFn:()=>v(),staleTime:3e5,placeholderData:b})}const B=["MRTA","RRTA","AATA","ARTA","FMCA","FCCA","FedCFamC2G","FCA","HCA"];function I(t){const r=new Map;for(const o of t.lineages)for(const s of o.courts)for(const[l,m]of Object.entries(s.case_count_by_year)){const i=parseInt(l,10);r.has(i)||r.set(i,{year:i});const a=r.get(i);a[s.code]=m}return Array.from(r.values()).sort((o,s)=>o.year-s.year)}function $({data:t}){const{t:r}=x(),o=A(),s=f.useMemo(()=>I(t),[t]);if(!s||s.length===0)return null;const l=new Set;for(const a of s)for(const n of Object.keys(a))n!=="year"&&l.add(n);const m=B.filter(a=>l.has(a)),i=(a,n)=>{o(`/cases?court=${a}&year=${n}`)};return e.jsx(N,{width:"100%",height:400,children:e.jsxs(y,{data:s,margin:{top:5,right:20,bottom:5,left:0},children:[e.jsx(T,{strokeDasharray:"3 3",stroke:"var(--color-border)"}),e.jsx(_,{dataKey:"year",tick:{fontSize:11,fill:"var(--color-text-secondary)"},tickFormatter:a=>String(a)}),e.jsx(R,{tick:{fontSize:11,fill:"var(--color-text-secondary)"}}),e.jsx(F,{content:({active:a,payload:n,label:c})=>{if(!a||!n)return null;const u=n.filter(d=>typeof d.value=="number"&&d.value>0);return u.length===0?null:e.jsxs("div",{style:{backgroundColor:"var(--color-background-card)",border:"1px solid var(--color-border)",borderRadius:"var(--radius)",color:"var(--color-text)",padding:"8px 12px",fontSize:12},children:[e.jsxs("p",{style:{fontWeight:600,marginBottom:4},children:[r("filters.date"),": ",c]}),u.map(d=>e.jsxs("p",{style:{color:d.color,margin:"2px 0"},children:[d.name,": ",Number(d.value).toLocaleString()]},d.dataKey))]})}}),e.jsx(k,{verticalAlign:"bottom",height:36,wrapperStyle:{fontSize:11,color:"var(--color-text-secondary)"}}),m.map(a=>e.jsx(w,{dataKey:a,stackId:"stack",fill:g[a]??"#8b8680",cursor:"pointer",onClick:n=>{const c=n;c&&typeof c.year=="number"&&i(a,c.year)},children:s.map((n,c)=>e.jsx(L,{style:{cursor:n[a]?"pointer":"default"}},`cell-${a}-${c}`))},a))]})})}const H=f.memo($);function K({data:t}){const{t:r}=x();if(!t||!t.lineages||t.lineages.length===0)return null;const o=s=>s==="lower-court"?S:G;return e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(p,{className:"h-6 w-6 text-accent"}),e.jsxs("div",{children:[e.jsx("h2",{className:"text-xl font-semibold text-foreground",children:r("lineage.explainer_title","Court Lineage Timeline")}),e.jsx("p",{className:"text-sm text-muted-text",children:r("lineage.explainer_subtitle","Understanding Australian immigration court and tribunal succession")})]})]}),t.lineages.map(s=>e.jsx(Y,{lineage:s,icon:o(s.id)},s.id))]})}function Y({lineage:t,icon:r}){const{t:o}=x();return e.jsxs("div",{className:"rounded-lg border border-border bg-card",children:[e.jsxs("div",{className:"flex items-center gap-2 border-b border-border p-4",children:[e.jsx(r,{className:"h-5 w-5 text-accent"}),e.jsx("h3",{className:"font-heading text-base font-semibold",children:t.name}),e.jsxs("span",{className:"ml-auto rounded-full bg-surface px-2 py-0.5 text-xs text-muted-text",children:[t.courts.length," courts"]})]}),e.jsxs("div",{className:"p-4",children:[e.jsx("div",{className:"flex flex-wrap items-center gap-2",children:t.courts.map((s,l)=>e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"flex flex-col items-center",children:e.jsxs("div",{className:"rounded-md border border-border bg-surface px-3 py-2",children:[e.jsx("p",{className:"font-mono text-xs font-medium text-accent",children:s.code}),e.jsxs("p",{className:"text-[10px] text-muted-text",children:[s.years[0],"â€“",s.years[1]===9999?"now":s.years[1]]})]})}),l<t.courts.length-1&&e.jsx(M,{className:"h-5 w-5 flex-shrink-0 text-accent"})]},s.code))}),t.transitions&&t.transitions.length>0&&e.jsxs("div",{className:"mt-4 space-y-3 border-t border-border-light pt-4",children:[e.jsx("h4",{className:"text-xs font-medium uppercase tracking-wide text-muted-text",children:o("lineage.transitions","Transitions")}),t.transitions.map(s=>e.jsxs("div",{className:"flex gap-3 rounded-md bg-surface p-3",children:[e.jsx("div",{className:"flex-shrink-0",children:e.jsx("div",{className:"flex h-6 w-6 items-center justify-center rounded-full bg-accent-muted text-xs font-medium text-accent",children:s.year})}),e.jsxs("div",{className:"flex-1",children:[e.jsxs("p",{className:"text-xs font-medium text-foreground",children:[e.jsx("span",{className:"font-mono",children:s.from})," â†’ ",e.jsx("span",{className:"font-mono",children:s.to})]}),e.jsx("p",{className:"mt-1 text-xs leading-relaxed text-muted-text",children:s.description})]})]},`${s.from}-${s.to}`))]})]})]})}function te(){const{t}=x(),{data:r,isLoading:o,isFetching:s,isError:l,error:m,refetch:i}=z();if(o&&!r)return e.jsx("div",{className:"flex h-64 items-center justify-center text-muted-text",children:t("common.loading_ellipsis")});if(l&&!r){const n=m instanceof Error?m.message:t("errors.api_request_failed",{name:"Court Lineage"});return e.jsx(h,{title:t("errors.failed_to_load",{name:"Court Lineage"}),message:n,onRetry:()=>{i()}})}if(!r)return e.jsx(h,{title:t("errors.data_unavailable",{name:"Court Lineage"}),message:t("errors.payload_error",{name:"Court Lineage"}),onRetry:()=>{i()}});if(r.total_cases===0&&!s)return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-semibold text-foreground",children:t("lineage.title","Court Lineage Timeline")}),e.jsx("p",{className:"text-sm text-muted-text",children:t("lineage.subtitle_empty","No case data available for lineage visualization")})]}),e.jsx(D,{icon:e.jsx(p,{className:"h-10 w-10"}),title:t("lineage.no_data_title","No Court Lineage Data"),description:t("lineage.no_data_description","Download cases first to visualize the court and tribunal succession timeline.")})]});const a=[{code:"MRTA",name:t("courts.MRTA","MRTA")},{code:"RRTA",name:t("courts.RRTA","RRTA")},{code:"AATA",name:t("courts.AATA","AATA")},{code:"ARTA",name:t("courts.ARTA","ARTA")},{code:"FMCA",name:t("courts.FMCA","FMCA")},{code:"FCCA",name:t("courts.FCCA","FCCA")},{code:"FedCFamC2G",name:t("courts.FedCFamC2G","FedCFamC2G")},{code:"FCA",name:t("courts.FCA","FCA")},{code:"HCA",name:t("courts.HCA","HCA")}];return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-semibold text-foreground",children:t("lineage.title","Court Lineage Timeline")}),e.jsx("p",{className:"text-sm text-muted-text",children:t("lineage.subtitle","Interactive visualization of Australian immigration court and tribunal succession from 2000 to present")})]}),e.jsxs("div",{className:"flex flex-wrap gap-4 text-sm",children:[e.jsxs("div",{children:[e.jsxs("span",{className:"text-muted-text",children:[t("lineage.total_cases","Total Cases"),":"]})," ",e.jsx("span",{className:"font-medium text-foreground",children:r.total_cases.toLocaleString()})]}),e.jsxs("div",{children:[e.jsxs("span",{className:"text-muted-text",children:[t("lineage.year_range","Years"),":"]})," ",e.jsxs("span",{className:"font-medium text-foreground",children:[r.year_range[0],"â€“",r.year_range[1]]})]}),e.jsxs("div",{children:[e.jsxs("span",{className:"text-muted-text",children:[t("lineage.courts_count","Courts/Tribunals"),":"]})," ",e.jsx("span",{className:"font-medium text-foreground",children:"9"})]})]}),e.jsxs("div",{className:"grid gap-6 lg:grid-cols-[minmax(320px,400px)_1fr]",children:[e.jsx("div",{className:"order-2 lg:order-1",children:e.jsx(K,{data:r})}),e.jsx("div",{className:"order-1 lg:order-2",children:e.jsxs("div",{className:"rounded-lg border border-border bg-card p-4",children:[e.jsx("h3",{className:"mb-4 font-heading text-base font-semibold text-foreground",children:t("lineage.timeline_chart_title","Case Volume by Court and Year")}),e.jsx("div",{className:"overflow-x-auto",children:e.jsx("div",{className:"min-w-[600px]",children:e.jsx(H,{data:r})})}),e.jsxs("div",{className:"mt-4 border-t border-border-light pt-4",children:[e.jsx("h4",{className:"mb-3 text-xs font-medium uppercase tracking-wide text-muted-text",children:t("lineage.court_colors","Court Colors")}),e.jsx("div",{className:"grid grid-cols-2 gap-x-4 gap-y-2 text-xs sm:grid-cols-3",children:a.map(n=>e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"h-3 w-3 rounded-sm",style:{backgroundColor:g[n.code]??"#8b8680"}}),e.jsx("span",{className:"font-mono text-foreground",children:n.code})]},n.code))})]})]})})]}),e.jsx("div",{className:"rounded-md border border-border-light bg-surface p-4 text-sm text-muted-text",children:e.jsx("p",{children:t("lineage.help_text","ðŸ’¡ Click any bar segment to view cases from that court and year. The chart shows the transition from older tribunals (MRTA, RRTA) to AATA and then ARTA, as well as the evolution of lower courts from FMCA through FCCA to FedCFamC2G.")})})]})}export{te as CourtLineagePage};
